{"version":3,"sources":["AudioMgr.js"],"names":["cc","Class","extends","Component","properties","bgmVolume","sfxVolume","bgmAudioID","init","t","sys","localStorage","getItem","parseFloat","game","on","EVENT_HIDE","audioEngine","pauseAll","EVENT_SHOW","resumeAll","getUrl","url","raw","playCard","type","value","playSFX","playHandleCard","playEvent","event","event_name_dict","event_name","sfx_name","parseInt","Math","random","playBGM","audioUrl","stop","play","setVolume","audioId","setSFXVolume","v","setItem","setBGMVolume","force"],"mappings":"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","file":"AudioMgr.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        bgmVolume: 1.0,\r\n        sfxVolume: 1.0,\r\n\r\n        bgmAudioID: -1,\r\n    },\r\n\r\n    // use this for initialization\r\n    init: function () {\r\n        var t = cc.sys.localStorage.getItem(\"bgmVolume\");\r\n        if(t != null){\r\n            this.bgmVolume = parseFloat(t);\r\n        }\r\n        \r\n        var t = cc.sys.localStorage.getItem(\"sfxVolume\");\r\n        if(t != null){\r\n            this.sfxVolume = parseFloat(t);    \r\n        }\r\n        \r\n        cc.game.on(cc.game.EVENT_HIDE, function () {\r\n            // console.log(\"cc.audioEngine.pauseAll\");\r\n            cc.audioEngine.pauseAll();\r\n        });\r\n        cc.game.on(cc.game.EVENT_SHOW, function () {\r\n            // console.log(\"cc.audioEngine.resumeAll\");\r\n            cc.audioEngine.resumeAll();\r\n        });\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n\r\n    getUrl: function (url) {\r\n        return cc.url.raw(\"resources/sounds/\" + url);\r\n    },\r\n\r\n    playCard(type, value) {\r\n        this.playSFX(\"common_woman/mjt\" + type + '_' + value + '.mp3')\r\n    },\r\n    playHandleCard: function (type) {\r\n        this.playSFX(\"common/audio_\" + type + '.mp3')\r\n    },\r\n    playEvent(event) {\r\n        let event_name_dict = {\r\n            2: ['chi', 3],\r\n            3: ['peng', 4],\r\n            4: ['gang', 2],\r\n            5: ['hu', 2]\r\n        }\r\n        let event_name = event_name_dict[event]\r\n        let sfx_name = 'common_woman/' + event_name[0] + parseInt(Math.random() * event_name[1] + 1) + '.mp3'\r\n        this.playSFX(sfx_name)\r\n    },\r\n\r\n    playBGM(url) {\r\n        this.audioUrl = this.getUrl(url);\r\n        if (this.bgmAudioID >= 0) {\r\n            cc.audioEngine.stop(this.bgmAudioID);\r\n        }\r\n        if (this.bgmVolume > 0) {\r\n            this.bgmAudioID = cc.audioEngine.play(this.audioUrl, true, this.bgmVolume);\r\n            cc.audioEngine.setVolume(this.bgmAudioID, this.bgmVolume);\r\n        }\r\n    },\r\n\r\n    playSFX(url) {\r\n        var audioUrl = this.getUrl(url);\r\n        if (this.sfxVolume > 0) {\r\n            var audioId = cc.audioEngine.play(audioUrl, false, this.sfxVolume);\r\n        }\r\n    },\r\n\r\n    setSFXVolume: function (v) {\r\n        if(this.sfxVolume != v ){\r\n            cc.sys.localStorage.setItem(\"sfxVolume\",v);\r\n            this.sfxVolume = v;\r\n        }\r\n        \r\n    },\r\n\r\n    setBGMVolume: function (v, force) {\r\n        if (this.bgmAudioID >= 0 && v < 0.00000001) {\r\n            cc.audioEngine.stop(this.bgmAudioID);\r\n            this.bgmAudioID = -1\r\n        }\r\n\r\n        if (v > 0 && this.bgmAudioID < 0) {\r\n            this.bgmAudioID = cc.audioEngine.play(this.audioUrl, true, v);\r\n        }\r\n\r\n        if (this.bgmVolume != v || force) {\r\n            cc.sys.localStorage.setItem(\"bgmVolume\",v);\r\n            this.bgmVolume = v;\r\n            cc.audioEngine.setVolume(this.bgmAudioID, v);\r\n        }\r\n    },\r\n\r\n    pauseAll: function () {\r\n        cc.audioEngine.pauseAll();\r\n    },\r\n\r\n    resumeAll: function () {\r\n        cc.audioEngine.resumeAll();\r\n    }\r\n});\r\n"]}