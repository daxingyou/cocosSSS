{"version":3,"sources":["OneRound.js"],"names":["cc","Class","extends","Component","properties","round","default","type","Label","created","btn_shared","Node","btn_check","replay_prefab","Prefab","onLoad","init","data","string","slice","i","score","node_score","node","getChildByName","active","getComponent","on","EventType","TOUCH_END","onReplay","bind","onShare","http","sendHall","method","game_id","resp","errno","mjroom","room_info","mj","mgr","self_seat","seat","replay","scene","showPrefab","detail","e","console","log","share_plugin","anysdk","agentManager","getSharePlugin","setListener","onShareResult","text","user","nickname","share_code","info","shareTo","mediaType","title","share","code","ShareResultCode","kShareSuccess","kShareFail","kShareCancel","kShareNetworkError"],"mappings":"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","file":"OneRound.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        round: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        created: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        btn_shared: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        btn_check: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        replay_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        }\r\n    },\r\n    onLoad: function () {\r\n\r\n    },\r\n    init: function (data) {\r\n        this.data = data\r\n        this.round.string = data.round\r\n        this.created.string = data.created.slice(5, 16)\r\n        for (let i = 1; i <= 4; i++) {\r\n            let score = data[\"role\" + i + \"_score\"]\r\n            if (score == \"\") {\r\n                continue\r\n            }\r\n            let node_score = this.node.getChildByName(\"score\" + i)\r\n            node_score.active = true\r\n            node_score.getComponent(cc.Label).string = score\r\n        }\r\n        this.btn_check.on(cc.Node.EventType.TOUCH_END, this.onReplay.bind(this))\r\n        this.btn_shared.on(cc.Node.EventType.TOUCH_END, this.onShare.bind(this))\r\n    },\r\n    onReplay: function () {\r\n        http.sendHall({ method: \"game_replay\", game_id: this.data.game_id, round: this.data.round }, (resp) => {\r\n            if (resp.errno) return\r\n            cc.mjroom = resp.room_info\r\n            cc.mj.mgr.self_seat = resp.seat\r\n            cc.mj.mgr.replay = true\r\n            try {\r\n                cc.scene.showPrefab(\"录像\", true, (node) => {\r\n                    node.getComponent(\"Replay\").init(resp.detail)\r\n                })\r\n            } catch (e) {\r\n                console.log(e)\r\n            }\r\n        })\r\n    },\r\n    onShare: function () {\r\n        var share_plugin = anysdk.agentManager.getSharePlugin();\r\n        share_plugin.setListener(this.onShareResult, this);\r\n        let text = \"福宁娱乐，快乐游戏，\" + cc.mj.user.nickname + \"邀请共同查看历史战绩回放，回放码为：\" + this.data.share_code\r\n        var info = {\r\n            shareTo: \"0\",\r\n            mediaType: \"0\",\r\n            title: \"福宁娱乐\",   // title 标题，印象笔记、邮箱、信息、微信、人人网和 QQ 空间使用\r\n            text: text,            // text 是分享文本，所有平台都需要这个字段\r\n        }\r\n        share_plugin.share(info)\r\n    },\r\n    onShareResult: function () {\r\n        switch (code) {\r\n            case anysdk.ShareResultCode.kShareSuccess:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareFail:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareCancel:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareNetworkError:\r\n                //do something\r\n                break;\r\n        }\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    // start () {\r\n\r\n    // },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}