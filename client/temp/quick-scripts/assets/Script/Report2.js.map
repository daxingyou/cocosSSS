{"version":3,"sources":["Report2.js"],"names":["cc","Class","extends","Component","properties","report_role_prefab","default","type","Prefab","btn_exit","Node","game_info","Label","btn_share","label_path","onLoad","on","EventType","TOUCH_START","mjroom","http","sendGame","method","resp","director","loadScene","club_type","share","bind","init","final","option","panel","node","getChildByName","layout","getComponent","Layout","role_num","roles","length","paddingLeft","spacingX","i","role","role_node","instantiate","owner_uid","id","winer","paoer","parent","room_info","cur_round","round","mode","option_text","time","string","text","name","score","share_plugin","anysdk","agentManager","getSharePlugin","setListener","onShareResult","screenShoot","path","info","shareTo","mediaType","title","imagePath","code","ShareResultCode","kShareSuccess","kShareFail","kShareCancel","kShareNetworkError"],"mappings":"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","file":"Report2.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        report_role_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        btn_exit: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        game_info: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        btn_share: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        label_path: cc.Label\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n    onLoad: function () {\r\n        this.btn_exit.on(cc.Node.EventType.TOUCH_START, () => {\r\n            cc.mjroom = null\r\n            http.sendGame({ method: \"exit_game\" }, (resp) => { })\r\n            if (this.type == \"PERSONAL\") {\r\n                cc.director.loadScene(\"hall\")\r\n            } else {\r\n                cc.club_type = this.type\r\n                cc.director.loadScene(\"club\")\r\n            }\r\n        })\r\n\r\n        this.btn_share.on(cc.Node.EventType.TOUCH_START, this.share.bind(this))\r\n    },\r\n    init: function (final) {\r\n        this.final = final\r\n        this.type = final.option.type\r\n        let panel = this.node.getChildByName(\"roles\")\r\n        let layout = panel.getComponent(cc.Layout)\r\n        let role_num = final.roles.length\r\n        if (role_num == 2) {\r\n            layout.paddingLeft = 238\r\n            layout.spacingX = 168\r\n        } else if (role_num == 3) {\r\n            layout.paddingLeft = 130\r\n            layout.spacingX = 58\r\n        }\r\n        for (let i = 0; i < role_num; i++) {\r\n            let role = final.roles[i]\r\n            let role_node = cc.instantiate(this.report_role_prefab)\r\n            role_node.getComponent(\"Report2Role\").init(role, final.owner_uid == role.id, final.winer == role.id, final.paoer == role.id)\r\n            role_node.parent = panel\r\n        }\r\n        let room_info = \"\"\r\n        room_info += \"房号 \" + final.id + \" 第 \" + final.cur_round + \"/\" + final.option.round + \"局\\n\"\r\n        room_info += (final.mode == \"fzmj\" ? \"福州麻将\" : \"宁德麻将\") + \" \" + final.option_text + \"\\n\"\r\n        room_info += final.time\r\n        this.game_info.string = room_info\r\n    },\r\n    share: function () {\r\n        let text = \"总结算分享：\"\r\n        text += \"福宁娱乐：房号\" + this.final.id + \"\\n\"\r\n        for (let i = 0; i < this.final.roles.length; i++) {\r\n            let role = this.final.roles[i]\r\n            text += role.name + \"：\" + role.score + \"\\n\"\r\n        }\r\n\r\n        var share_plugin = anysdk.agentManager.getSharePlugin();\r\n        share_plugin.setListener(this.onShareResult, this);\r\n\r\n        cc.screenShoot((path) => {\r\n            var info = {\r\n                shareTo: \"0\",\r\n                mediaType: \"1\",\r\n                title: \"福宁娱乐\",   // title 标题，印象笔记、邮箱、信息、微信、人人网和 QQ 空间使用\r\n                text: text,            // text 是分享文本，所有平台都需要这个字段\\\r\n                imagePath: path\r\n            }\r\n            share_plugin.share(info)\r\n\r\n        })\r\n        //let path = cc.screenShoot()\r\n    },\r\n    onShareResult: function () {\r\n        switch (code) {\r\n            case anysdk.ShareResultCode.kShareSuccess:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareFail:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareCancel:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareNetworkError:\r\n                //do something\r\n                break;\r\n        }\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    // start () {\r\n\r\n    // },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}