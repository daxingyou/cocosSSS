{"version":3,"sources":["MJGame.js"],"names":["ScenePopWin","require","cc","Class","extends","seat","properties","right","default","type","Node","up","left","bottom","self_cur_card_prefab","Prefab","self_out_card_prefab","self_peng_prefab","self_out_card_big_prefab","left_cur_card_prefab","left_peng_prefab","left_out_card_prefab","left_out_card_big_prefab","up_peng_gang_prefab","up_cur_card_prefab","up_out_card_prefab","up_out_card_big_prefab","right_peng_gang_prefab","right_cur_card_prefab","right_out_card_prefab","right_out_card_big_prefab","self_turn","left_turn","up_turn","right_turn","deadline","Label","ani_hua_prefab","ani_kaijin_prefab","header_prefab","event_handler_prefab","remainder_cards","total_round","cur_round","jin_card","ani_event_prefab","tips_prefab","hua_show_prefab","invite_prefab","dismiss_msg_prefab","game_setting_prefab","chat_prefab","right_chat_prefab","up_chat_prefab","left_chat_prefab","bottom_chat_prefab","biaoqing_prefab","btn_back","btn_dismiss","btn_invite_club","btn_invite_wx","findNode","dir","name","node_names","split","node","dir_dict","i","length","getChildByName","randomInit","peng_pang_num","parseInt","Math","random","active","peng","instantiate","peng_prefab_dict","getComponent","init","parent","cur_card_prefab_dict","card_script","self_new_card","out_cards_num","out_card_prefab_dict","cards_arr","push","value","j","idx","out_cards_pathis","refreshRightOutCard","data","right_out_cards","last_discard","JSON","parse","stringify","out_panel","node_out_cards","_children","removeAllChildren","num","card","out_card","last_out_card","start_play","cs","initComponents","out_card_big_prefab_dict","turn_dict","chat_dict","initSelfCards","resp","roles","uid","mj","mgr","initCards","cards","card_len","self_cards","cur_card_prefab","laizi","new_card","initOtherCards","role","Utils","dirFromSeat","role_cards","_onLoad","game","room","mjroom","bg","find","user","getStyleBg","initTitle","audio","playBGM","laizi_show","ignore_animation","timer_dict","chat_msgs","initEvt","string","option_text","initBtn","initInvitionBtn","regHideShowEvent","start","club_id","owner_uid","onShowChat","scene","showPrefab","onDismiss","option","onShowTips","http","sendGame","method","director","loadScene","club_type","onShowClubMembers","btn_wx","on","EventType","TOUCH_END","onShare","bind","makeShareText","text","max_role","id","round","game_cfg","url_android","url_ios","log","share_plugin","anysdk","agentManager","getSharePlugin","setListener","onShareResult","info","shareTo","mediaType","title","share","code","ShareResultCode","kShareSuccess","kShareFail","kShareCancel","kShareNetworkError","evts","recover","evt","hasEvt","handleEvt","finished","Task","resume","startHeartbeat","handle_next","_0","v","cur_time_string","date","Date","month","getMonth","day","getDate","hour","getHours","min","getMinutes","t","room_text","onTask","EVENT_HIDE","onHide","EVENT_SHOW","onShow","pause","heartbeat","onRecover","recoverChecked","onClickBack","runAfter","func","handle_event","self","handle_next_cb","newTurn","cur_seat","k","newDeadline","cb","deadline_cb","deadline_sec","playSFX","max","play_animation","animation_prefab","timeout","animation","animation_node","refreshSelfCards","self_seat","cur_normal_old_node","cur_len","len","onPrepare","checkHua","PreDiscard","out_card_big","onShowSetting","regEvt","no_waiting","invite_node","btn_check_hua","banker","card_num","prepare_header","header","icon","money","banker_dir","set_banker","hu_times","e","console","stop_play","event_handler_node","_discard","parseCard","playCard","self_selected_card","reset","node_new","node_card","card_cs","playHandleCard","_components","cur_hua","rpl_cards","rpl_card","replaceCard","type0","value0","type1","value1","event","event_btn","selects","state","guo_btn","cs_guo","from_dir","from_seat","event_cards_node","splice","playEvent","ani_event","remove_num","event_card","gang","otherEvent","value2","chi","exit","off","result","kaijin","prepare","card_node","Layout","spacingY","room_type","content","dismissed","names","join","refused","chat_node","msg","msgSFX","set_offline","offline","to_dir","to_seat","times","biaoqing","cur_cards_node","stopHeartbeat","COMMON_MSG","_onDisable","update","dt"],"mappings":"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","file":"MJGame.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["var ScenePopWin = require('./lib/ScenePopWin')\r\n\r\ncc.Class({\r\n    extends: ScenePopWin,\r\n    seat: null,\r\n    properties: {\r\n        right: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        up: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        left: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        bottom: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        self_cur_card_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        self_out_card_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        self_peng_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        self_out_card_big_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        left_cur_card_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        left_peng_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        left_out_card_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        left_out_card_big_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        up_peng_gang_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        up_cur_card_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        up_out_card_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        up_out_card_big_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        right_peng_gang_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        right_cur_card_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        right_out_card_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        right_out_card_big_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        self_turn: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        left_turn: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        up_turn: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        right_turn: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        deadline: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        ani_hua_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        ani_kaijin_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        header_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        event_handler_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        remainder_cards: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        total_round: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        cur_round: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        jin_card: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        ani_event_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        tips_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        hua_show_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        invite_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        dismiss_msg_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        game_setting_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        chat_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        right_chat_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        up_chat_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        left_chat_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        bottom_chat_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        biaoqing_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        btn_back: cc.Node,\r\n        btn_dismiss: cc.Node,\r\n        btn_invite_club: cc.Node,\r\n        btn_invite_wx: cc.Node\r\n    },\r\n    findNode: function (dir, name) {\r\n        let node_names = name.split(\".\")\r\n        let node = this.dir_dict[dir]\r\n        for (let i = 0; i < node_names.length; i++) {\r\n            node = node.getChildByName(node_names[i])\r\n        }\r\n        return node\r\n    },\r\n    randomInit: function (dir) {\r\n        let peng_pang_num = parseInt(Math.random() * 5)\r\n        if (!peng_pang_num) {\r\n            this.findNode(dir, \"cur.event\").active = false\r\n        }\r\n        for (let i = 0; i < peng_pang_num; i++) {\r\n            let peng = cc.instantiate(this.peng_prefab_dict[dir])\r\n            peng.getComponent(\"EventCard\").init(dir, parseInt(Math.random() * 3 + 1), parseInt(Math.random() * 9 + 1))\r\n            peng.parent = this.findNode(dir, \"cur.event\")\r\n        }\r\n        for (let i = 0; i < 17 - peng_pang_num * 3 - 1; i++) {\r\n            let self_cur_card_prefab = cc.instantiate(this.cur_card_prefab_dict[dir]);\r\n            let card_script = self_cur_card_prefab.getComponent(\"CurCard\")\r\n            if (card_script) {\r\n                card_script.init(dir, parseInt(Math.random() * 3 + 1), parseInt(Math.random() * 9 + 1))\r\n            }\r\n            self_cur_card_prefab.parent = this.findNode(dir, \"cur.normal.old\")\r\n        }\r\n\r\n        let self_new_card = cc.instantiate(this.cur_card_prefab_dict[dir]);\r\n        self_new_card.parent = this.findNode(dir, \"cur.normal.new\")\r\n\r\n        let out_cards_num = parseInt(Math.random() * 12 + 2)\r\n        if (dir != 1) {\r\n            for (let i = 0; i < out_cards_num; i++) {\r\n                let self_cur_card_prefab = cc.instantiate(this.out_card_prefab_dict[dir]);\r\n                let card_script = self_cur_card_prefab.getComponent(\"OutCard\")\r\n                if (card_script) {\r\n                    card_script.init(dir, parseInt(Math.random() * 3 + 1), parseInt(Math.random() * 9 + 1))\r\n                }\r\n                self_cur_card_prefab.parent = this.findNode(dir, \"out\")\r\n            }\r\n        } else {\r\n            let cards_arr = []\r\n            for (let i = 0; i < out_cards_num; i++) {\r\n                cards_arr.push({ type: parseInt(Math.random() * 3 + 1), value: parseInt(Math.random() * 9 + 1) })\r\n            }\r\n            out_cards_num = parseInt(out_cards_num / 10 + 1) * 10\r\n            for (let i = cards_arr.length; i < out_cards_num; i++) {\r\n                cards_arr.push({ type: null, value: null })\r\n            }\r\n            for (let i = 0; i < parseInt(out_cards_num / 10); i++) {\r\n                for (let j = 9; j >= 0; j--) {\r\n                    let self_cur_card_prefab = cc.instantiate(this.out_card_prefab_dict[dir]);\r\n                    let card_script = self_cur_card_prefab.getComponent(\"OutCard\")\r\n                    let idx = i * 10 + j\r\n                    if (card_script) {\r\n                        card_script.init(dir, cards_arr[idx].type, cards_arr[idx].value)\r\n                    }\r\n                    self_cur_card_prefab.parent = this.out_cards_pathis.findNode(dir, \"out\")\r\n                }\r\n            }\r\n        }\r\n\r\n    },\r\n    refreshRightOutCard: function (data) {\r\n        for (let i = 0; i < this.right_out_cards.length; i++) {\r\n            this.right_out_cards[i].last_discard = false\r\n        }\r\n        data.last_discard = true\r\n        this.right_out_cards.push(data)\r\n        let dir = 1\r\n        let cards_arr = JSON.parse(JSON.stringify(this.right_out_cards))\r\n        let out_cards_num = cards_arr.length\r\n        out_cards_num = parseInt(out_cards_num / 10 + 1) * 10\r\n        for (let i = cards_arr.length; i < out_cards_num; i++) {\r\n            cards_arr.push({ type: null, value: null })\r\n        }\r\n        let out_panel = this.findNode(dir, \"out\")\r\n        let node_out_cards = []\r\n        for (let i = 0; i < out_panel._children.length; i++) {\r\n            node_out_cards.push(out_panel._children[i])\r\n        }\r\n        out_panel.removeAllChildren()\r\n\r\n        let num = 0\r\n        for (let i = 0; i < parseInt(out_cards_num / 10); i++) {\r\n            for (let j = 9; j >= 0; j--) {\r\n                num += 1\r\n                let idx = i * 10 + j\r\n                let card = cards_arr[idx]\r\n                let out_card = null\r\n                if (card.last_discard) {\r\n                    out_card = this.last_out_card\r\n                    out_card.getComponent(\"OutCard\").start_play()\r\n                } else {\r\n                    if (num <= node_out_cards.length) {\r\n                        out_card = node_out_cards[num - 1]\r\n                    } else {\r\n                        out_card = cc.instantiate(this.out_card_prefab_dict[dir]);\r\n                    }\r\n                    let cs = out_card.getComponent(\"OutCard\")\r\n                    cs.init(dir, card.type, card.value)\r\n                }\r\n                out_card.parent = out_panel\r\n            }\r\n        }\r\n\r\n        // for (let i = 0; i < parseInt(out_cards_num / 10); i++) {\r\n        //     for (let j = 9; j >= 0; j--) {\r\n        //         let idx = i * 10 + j\r\n        //         let card = cards_arr[idx]\r\n        //         let out_card = null\r\n        //         if (card.last_discard) {\r\n        //             out_card = this.last_out_card\r\n        //             out_card.getComponent(\"OutCard\").start_play()\r\n        //         } else {\r\n        //             out_card = cc.instantiate(this.out_card_prefab_dict[dir]);\r\n        //             let cs = out_card.getComponent(\"OutCard\")\r\n        //             cs.init(dir, card.type, card.value)\r\n        //         }\r\n        //         out_card.parent = out_panel\r\n        //     }\r\n        // }\r\n    },\r\n    initComponents: function () {\r\n        this.dir_dict = {\r\n            1: this.right,\r\n            2: this.up,\r\n            3: this.left,\r\n            4: this.bottom\r\n        }\r\n        this.peng_prefab_dict = {\r\n            1: this.right_peng_gang_prefab,\r\n            2: this.up_peng_gang_prefab,\r\n            3: this.left_peng_prefab,\r\n            4: this.self_peng_prefab\r\n        }\r\n        this.cur_card_prefab_dict = {\r\n            1: this.right_cur_card_prefab,\r\n            2: this.up_cur_card_prefab,\r\n            3: this.left_cur_card_prefab,\r\n            4: this.self_cur_card_prefab\r\n        }\r\n        this.out_card_prefab_dict = {\r\n            1: this.right_out_card_prefab,\r\n            2: this.up_out_card_prefab,\r\n            3: this.left_out_card_prefab,\r\n            4: this.self_out_card_prefab,\r\n        }\r\n        this.out_card_big_prefab_dict = {\r\n            1: this.right_out_card_big_prefab,\r\n            2: this.up_out_card_big_prefab,\r\n            3: this.left_out_card_big_prefab,\r\n            4: this.self_out_card_big_prefab,\r\n        }\r\n        this.turn_dict = {\r\n            1: this.right_turn,\r\n            2: this.up_turn,\r\n            3: this.left_turn,\r\n            4: this.self_turn\r\n        }\r\n        this.chat_dict = {\r\n            1: this.right_chat_prefab,\r\n            2: this.up_chat_prefab,\r\n            3: this.left_chat_prefab,\r\n            4: this.bottom_chat_prefab\r\n        }\r\n    },\r\n    // use this for initialization\r\n    initSelfCards: function (resp) {\r\n        this.findNode(this.dir, \"cur.event\").removeAllChildren()\r\n        this.findNode(this.dir, \"cur.normal.old\").removeAllChildren()\r\n        this.findNode(this.dir, \"cur.normal.new\").removeAllChildren()\r\n        this.findNode(this.dir, \"out\").removeAllChildren()\r\n\r\n        for (let i = 0; i < resp.roles.length; i++) {\r\n            if (resp.roles[i].uid == cc.mj.mgr.uid) {\r\n                cc.mj.mgr.initCards(resp.roles[i].cards)\r\n                break\r\n            }\r\n        }\r\n        this.findNode(this.dir, \"cur.event\").active = false\r\n        let card_len = cc.mj.mgr.self_cards.length\r\n        for (let i = 0; i < card_len; i++) {\r\n            let card = cc.mj.mgr.self_cards[i]\r\n            let cur_card_prefab = cc.instantiate(this.cur_card_prefab_dict[this.dir]);\r\n            cur_card_prefab.getComponent(\"CurCard\").init(this.dir, card.type, card.value, card.laizi, this)\r\n            cur_card_prefab.parent = this.findNode(this.dir, \"cur.normal.old\")\r\n        }\r\n        if (cc.mj.mgr.new_card) {\r\n            let card = cc.mj.mgr.new_card\r\n            let new_card = cc.instantiate(this.cur_card_prefab_dict[this.dir]);\r\n            new_card.getComponent(\"CurCard\").init(this.dir, card.type, card.value, card.laizi, this)\r\n            new_card.parent = this.findNode(this.dir, \"cur.normal.new\")\r\n        }\r\n\r\n    },\r\n    initOtherCards: function (resp) {\r\n        for (let i = 0; i < resp.roles.length; i++) {\r\n            let role = resp.roles[i]\r\n            if (role.uid == cc.mj.mgr.uid) {\r\n                continue\r\n            }\r\n            let dir = Utils.dirFromSeat(role.seat)\r\n            this.findNode(dir, \"cur.event\").removeAllChildren()\r\n            this.findNode(dir, \"cur.normal.old\").removeAllChildren()\r\n            this.findNode(dir, \"out\").removeAllChildren()\r\n            this.findNode(dir, \"cur.normal.new\").removeAllChildren()\r\n            this.findNode(dir, \"hua\").active = false\r\n\r\n            let role_cards = role.cards\r\n            this.findNode(dir, \"cur.event\").active = false\r\n            for (let i = 0; i < role_cards.length; i++) {\r\n                let card = role_cards[i]\r\n                let cur_card_prefab = cc.instantiate(this.cur_card_prefab_dict[dir]);\r\n                cur_card_prefab.parent = this.findNode(dir, \"cur.normal.old\")\r\n            }\r\n        }\r\n    },\r\n    _onLoad: function () {\r\n        cc.mj.game = this\r\n        this.room = cc.mjroom\r\n        this.bg = cc.find(\"Canvas/bg_\" + cc.mj.user.getStyleBg())\r\n        this.bg.active = true\r\n        this.initTitle()\r\n        cc.audio.playBGM(\"bgm2.mp3\")\r\n        cc.mj.mgr.uid = cc.mj.user.uid\r\n        this.laizi_show = cc.find(\"Canvas/gaming/laizi\")\r\n        this.laizi_show.active = false\r\n        this.right_out_cards = [] //右侧出牌特殊处理\r\n        this.ignore_animation = false\r\n        this.timer_dict = {}\r\n        this.chat_msgs = []\r\n\r\n        this.dir = 4\r\n        this.initComponents()\r\n        this.initEvt()\r\n        // this.recoverGame()\r\n        cc.find(\"Canvas/prepare/option\").getComponent(cc.Label).string = this.room.option_text\r\n        this.initBtn()\r\n        this.initInvitionBtn()\r\n        this.regHideShowEvent()\r\n\r\n        this.start()\r\n    },\r\n    initBtn: function () {\r\n        this.btn_dismiss.active = this.room.cur_round == 0\r\n        this.btn_invite_club.active = this.room.cur_round == 0 && this.room.club_id != '0'\r\n        this.btn_invite_wx.active = this.room.cur_round == 0\r\n        this.btn_back.active = this.room.owner_uid == cc.mj.user.uid\r\n    },\r\n    onShowChat: function () {\r\n        cc.scene.showPrefab(\"聊天框\", false, (node) => {\r\n            node.getComponent(\"Chat\").init(this.chat_msgs)\r\n        })\r\n    },\r\n    onDismiss: function () {\r\n        let type = this.room.option.type\r\n        if (type == \"PERSONAL\") {\r\n            if (this.room.owner_uid == cc.mj.user.uid) {\r\n                cc.scene.onShowTips(\"OK_CANCEL\", \"解散房间不扣房卡，是否确定解散？\", () => {\r\n                    http.sendGame({ method: \"exit_game\" }, () => { cc.mjroom = null; cc.director.loadScene(\"hall\") })\r\n                })\r\n            } else {\r\n                http.sendGame({ method: \"exit_game\" }, () => { cc.mjroom = null; cc.director.loadScene(\"hall\") })\r\n            }\r\n        } else {\r\n            cc.club_type = this.room.option.type\r\n            http.sendGame({ method: \"exit_game\" }, () => { cc.mjroom = null; cc.director.loadScene(\"club\") })\r\n        }\r\n    },\r\n    onShowClubMembers: function () {\r\n        cc.mj.user.club_id = this.room.club_id\r\n        cc.scene.showPrefab(\"邀请俱乐部成员\")\r\n    },\r\n    initInvitionBtn: function () {\r\n        if (this.room.cur_round == 0) {\r\n            let btn_wx = cc.find(\"Canvas/prepare/invite/btn_invite_wx\")\r\n            btn_wx.active = true\r\n            btn_wx.on(cc.Node.EventType.TOUCH_END, this.onShare.bind(this))\r\n        }\r\n    },\r\n    makeShareText() {\r\n        let text = \"福宁娱乐：\"\r\n        text += this.room.option.mj == \"fzmj\" ? \"福州\" : \"宁德\"\r\n        text += (this.room.option.max_role == 2 ? \"二\" : this.room.option.max_role == 3 ? \"三\" : \"四\") + \"人, \"\r\n        text += \"房号：\" + this.room.id + \"(\" + this.room.option.round + \"局), \"\r\n        text += this.room.option_text + \"\\n\"\r\n        text += \"安卓手机点击：\" + cc.mj.game_cfg.url_android + \"，\"\r\n        text += \"苹果手机点击：\" + cc.mj.game_cfg.url_ios\r\n        return text\r\n    },\r\n    onShare: function () {\r\n        let text = this.makeShareText()\r\n        cc.log(text)\r\n\r\n        var share_plugin = anysdk.agentManager.getSharePlugin();\r\n        share_plugin.setListener(this.onShareResult, this);\r\n\r\n        var info = {\r\n            shareTo: \"0\",\r\n            mediaType: \"0\",\r\n            title: \"福宁娱乐\",   // title 标题，印象笔记、邮箱、信息、微信、人人网和 QQ 空间使用\r\n            text: text,            // text 是分享文本，所有平台都需要这个字段\r\n        }\r\n        share_plugin.share(info)\r\n    },\r\n    onShareResult: function () {\r\n        switch (code) {\r\n            case anysdk.ShareResultCode.kShareSuccess:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareFail:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareCancel:\r\n                //do something\r\n                break;\r\n            case anysdk.ShareResultCode.kShareNetworkError:\r\n                //do something\r\n                break;\r\n        }\r\n    },\r\n\r\n    init: function (evts) {\r\n        this.evts = evts\r\n    },\r\n    recover: function () {\r\n        if (cc.mj.mgr.recover) {\r\n            cc.log(\"恢复游戏\")\r\n            this.ignore_animation = true\r\n            while (cc.mj.evt.hasEvt()) {\r\n                cc.mj.evt.handleEvt()\r\n            }\r\n            this.ignore_animation = false\r\n            cc.mj.mgr.recover = false\r\n        }\r\n    },\r\n    start: function () {\r\n        this.recover()\r\n        if (!this.finished) {\r\n            Task.resume()\r\n            http.startHeartbeat()\r\n            this.handle_next()\r\n        }\r\n    },\r\n    initTitle: function () {\r\n        let title = this.bg.getChildByName(\"title\").getComponent(cc.Label)\r\n        let _0 = (v) => { return v > 9 ? v : (\"0\" + v) }\r\n        let cur_time_string = () => {\r\n            var date = new Date();\r\n            let month = _0(date.getMonth() + 1)\r\n            let day = _0(date.getDate())\r\n            let hour = _0(date.getHours())\r\n            let min = _0(date.getMinutes())\r\n            let t = \"\" + month + \"-\" + day + \" \" + hour + \":\" + min\r\n            return t\r\n        }\r\n        this.room.room_text ? this.room.room_text:''\r\n        title.string = this.room.room_text + \"   \" + cur_time_string()\r\n        Task.onTask(60 * 1000, () => {\r\n            title.string = this.room.room_text + \"   \" + cur_time_string()\r\n        })\r\n    },\r\n    regHideShowEvent: function () {\r\n        cc.game.on(cc.game.EVENT_HIDE, this.onHide, this)\r\n        cc.game.on(cc.game.EVENT_SHOW, this.onShow, this)\r\n    },\r\n    onHide: function () {\r\n        Task.pause()\r\n    },\r\n    onShow: function () {\r\n        http.heartbeat(() => {\r\n            cc.mj.mgr.recover = true\r\n            this.start()\r\n        })\r\n    },\r\n    onRecover: function () {\r\n        cc.recoverChecked = false\r\n        cc.director.loadScene(\"hall\")\r\n    },\r\n    onClickBack: function () {\r\n        cc.scene.onShowTips(\"OK_CANCEL\", \"返回大厅您的房间仍会保留哦！\", () => {\r\n            let type = this.room.option.type\r\n            if (type == \"PERSONAL\") {\r\n                cc.director.loadScene(\"hall\")\r\n            } else {\r\n                cc.club_type = this.room.option.type\r\n                cc.director.loadScene(\"club\")\r\n            }\r\n        })\r\n    },\r\n    runAfter: function (func, t) {\r\n        if (!t) {\r\n            func()\r\n            return null\r\n        }\r\n        else {\r\n            Task.runAfter(t, func)\r\n        }\r\n    },\r\n    handle_event: function () {\r\n        if (cc.mj.evt.hasEvt()) cc.mj.evt.handleEvt()\r\n        else this.handle_next()\r\n    },\r\n    handle_next: function () {\r\n        let self = this\r\n        this.handle_next_cb = function () {\r\n            self.handle_event()\r\n        }\r\n        Task.runAfter(16, this.handle_next_cb)\r\n    },\r\n    newTurn: function () {\r\n        let dir = Utils.dirFromSeat(cc.mj.mgr.cur_seat)\r\n        for (let k in this.turn_dict) {\r\n            this.turn_dict[k].active = k == dir ? true : false\r\n        }\r\n        this.newDeadline()\r\n    },\r\n    newDeadline: function (cb) {\r\n        this.deadline.string = 10\r\n        if (this.deadline_cb) return\r\n        let self = this\r\n        this.deadline_cb = function () {\r\n            let deadline_sec = parseInt(self.deadline.string) - 1\r\n            if (deadline_sec == 3) {\r\n                cc.audio.playSFX(\"common/timeup_alarm.mp3\")\r\n            }\r\n            self.deadline.string = '' + Math.max(0, deadline_sec)\r\n        }\r\n        Task.onTask(1000, this.deadline_cb)\r\n    },\r\n    play_animation: function (seat, animation_prefab, timeout, cb) {\r\n        if (!this.ignore_animation) {\r\n            let dir = Utils.dirFromSeat(seat)\r\n            let animation = cc.instantiate(animation_prefab)\r\n            let animation_node = this.findNode(dir, \"ani_event\")\r\n            animation_node.removeAllChildren()\r\n            animation.parent = animation_node\r\n            this.runAfter(() => {\r\n                animation.parent = null\r\n                cb && cb()\r\n            }, timeout)\r\n        } else {\r\n            cb && cb()\r\n        }\r\n\r\n    },\r\n    refreshSelfCards: function () {\r\n        let dir = Utils.dirFromSeat(cc.mj.mgr.self_seat)\r\n        let cur_normal_old_node = this.findNode(dir, \"cur.normal.old\")\r\n        let cur_len = cur_normal_old_node._children.length\r\n        let card_len = cc.mj.mgr.self_cards.length\r\n        let len = cur_len >= card_len ? cur_len : card_len\r\n\r\n        for (let i = 0; i < len; i++) {\r\n            let card = null\r\n            if (i >= cur_len) {\r\n                card = cc.instantiate(this.cur_card_prefab_dict[dir])\r\n                card.parent = this.findNode(dir, \"cur.normal.old\")\r\n            } else {\r\n                card = cur_normal_old_node._children[i]\r\n            }\r\n            if (i >= card_len) {\r\n                card.active = false\r\n            } else {\r\n                card.active = true\r\n                let card_script = card.getComponent(\"CurCard\")\r\n                card_script.init(this.dir, cc.mj.mgr.self_cards[i].type, cc.mj.mgr.self_cards[i].value, cc.mj.mgr.self_cards[i].laizi, this)\r\n            }\r\n        }\r\n        if (cc.mj.mgr.new_card) {\r\n            let card_script = this.findNode(dir, \"cur.normal.new\")._children[0].getComponent(\"CurCard\")\r\n            card_script.init(this.dir, cc.mj.mgr.new_card.type, cc.mj.mgr.new_card.value, cc.mj.mgr.new_card.laizi, this)\r\n        }\r\n    },\r\n    onPrepare: function () {\r\n        http.sendGame({ method: \"prepare\" }, (resp) => { })\r\n    },\r\n    checkHua: function () {\r\n        http.sendGame({ method: \"check_hua\" }, (resp) => {\r\n            cc.scene.showPrefab(\"查看花牌\", false, (node) => {\r\n                node.getComponent(\"RoleHuaShow\").init(resp.roles)\r\n            })\r\n        })\r\n    },\r\n    PreDiscard: function (type, value) {\r\n        return\r\n        let out_card_big = cc.instantiate(this.out_card_big_prefab_dict[4]);\r\n        out_card_big.getComponent(\"OutCard\").init(4, type, value, null, true)\r\n        out_card_big.parent = this.findNode(4, \"out_big\")\r\n    },\r\n    onShowSetting: function () {\r\n        cc.scene.showPrefab(\"设置\", false, (node) => {\r\n            node.getComponent(\"Setting\").init(\"GAME\")\r\n        })\r\n    },\r\n    initEvt: function () {\r\n        // 初始化牌局\r\n        cc.mj.evt.regEvt(\"InitGame\", (data) => {\r\n            cc.log(data);\r\n            this.no_waiting = true\r\n            this.right_out_cards = [] //右侧出牌特殊处理\r\n            let invite_node = this.node.getChildByName(\"invite_cluber\")\r\n            invite_node && (invite_node.parent = null)\r\n            cc.find(\"Canvas/prepare\").active = false\r\n            let btn_check_hua = cc.find(\"Canvas/gaming/btn_check_hua\")\r\n            if (this.room.option.mj != \"fzmj\") {\r\n                btn_check_hua.active = false\r\n            } else {\r\n                !btn_check_hua.active && (btn_check_hua.active = true) && (btn_check_hua.on(cc.Node.EventType.TOUCH_END, this.checkHua.bind(this)))\r\n            }\r\n            cc.mj.mgr.cur_seat = data.banker.seat\r\n            this.remainder_cards.string = data.card_num\r\n            this.initSelfCards(data)\r\n            this.initOtherCards(data)\r\n            for (let i = 1; i <= 4; i++) {\r\n                this.findNode(i, \"prepare\").active = false\r\n            }\r\n            for (let i = 0; i < data.roles.length; i++) {\r\n                let role = data.roles[i]\r\n                let dir = Utils.dirFromSeat(role.seat)\r\n                let prepare_header = this.findNode(dir, 'prepare_header')\r\n                if (!this.findNode(dir, 'gaming_header')._children.length) {\r\n                    if (!prepare_header._children.length) {\r\n                        prepare_header.active = true\r\n                        let header = cc.instantiate(this.header_prefab)\r\n                        let cs = header.getComponent(\"Header\")\r\n                        cs.init(this, dir, role.uid, role.name, role.icon, role.money)\r\n                        header.parent = this.findNode(dir, 'gaming_header')\r\n                    } else {\r\n                        prepare_header._children[0].parent = this.findNode(dir, 'gaming_header')\r\n                    }\r\n                }\r\n                prepare_header.active = false\r\n            }\r\n            this.cur_round.string = data.cur_round\r\n            this.total_round.string = this.room.option.round\r\n            cc.find(\"Canvas/gaming/turn/option\").getComponent(cc.Label).string = this.room.option_text\r\n            cc.find(\"Canvas/gaming/turn\").active = true\r\n            this.newTurn()\r\n\r\n            try {\r\n                let banker_dir = Utils.dirFromSeat(data.banker.seat)\r\n                if (banker_dir != this.dir) {\r\n                    this.findNode(banker_dir, \"cur.normal.old\")._children[0].parent = null\r\n                    let new_card = cc.instantiate(this.cur_card_prefab_dict[banker_dir]);\r\n                    new_card.parent = this.findNode(banker_dir, \"cur.normal.new\")\r\n                }\r\n                this.findNode(banker_dir, \"gaming_header\")._children[0].getComponent(\"Header\").set_banker(data.banker.hu_times)\r\n            } catch (e) { console.log(e) }\r\n\r\n            !this.ignore_animation && this.handle_next()\r\n        })\r\n        // 玩家出牌\r\n        cc.mj.evt.regEvt(\"UserDiscard\", (data) => {\r\n            cc.mj.mgr.cur_seat = null\r\n            this.last_out_card && this.last_out_card.getComponent(\"OutCard\").stop_play()\r\n            this.last_out_card = null\r\n            this.out_card_big && (this.out_card_big.parent = null)\r\n\r\n            let dir = Utils.dirFromSeat(data.seat)\r\n            this.findNode(dir, \"out_big\").removeAllChildren()\r\n            // 移除操作确定\r\n            let event_handler_node = this.findNode(this.dir, \"event_handler\")\r\n            event_handler_node.removeAllChildren()\r\n\r\n            let self = this\r\n            let _discard = (dir, data) => {\r\n                if (dir != 1) {\r\n                    this.last_out_card.parent = self.findNode(dir, \"out\")\r\n                    this.last_out_card.getComponent(\"OutCard\").start_play()\r\n                } else {\r\n                    this.refreshRightOutCard(data)\r\n                }\r\n                !this.ignore_animation && this.handle_next()\r\n            }\r\n            let card = Utils.parseCard(data.card)\r\n            this.last_out_card = cc.instantiate(self.out_card_prefab_dict[dir]);\r\n            this.last_out_card.getComponent(\"OutCard\").init(dir, card.type, card.value)\r\n            if (!this.ignore_animation && dir != this.dir) {\r\n                this.out_card_big = cc.instantiate(this.out_card_big_prefab_dict[4]);\r\n                this.out_card_big.getComponent(\"OutCard\").init(4, card.type, card.value, null, true)\r\n                this.out_card_big.parent = this.findNode(dir, \"out_big\")\r\n                this.runAfter(() => {\r\n                    _discard(dir, card)\r\n                })\r\n                this.runAfter(() => {\r\n                    this.out_card_big.parent = null\r\n                }, 800)\r\n            } else {\r\n                _discard(dir, card)\r\n            }\r\n            !this.ignore_animation && cc.audio.playCard(card.type, card.value)\r\n            if (this.findNode(dir, \"cur.normal.new\")._children.length && this.findNode(dir, \"cur.normal.new\")._children[0].active) {\r\n                this.findNode(dir, \"cur.normal.new\")._children[0].active = false\r\n            } else if (dir != 4) {\r\n                this.findNode(dir, \"cur.normal.old\")._children[this.findNode(dir, \"cur.normal.old\")._children.length - 1].parent = null\r\n            }\r\n\r\n            if (data.uid == cc.mj.mgr.uid) {\r\n                if (cc.mj.mgr.self_selected_card) {\r\n                    cc.mj.mgr.self_selected_card.reset(this.findNode(dir, \"cur.normal.old\"))\r\n                }\r\n                cc.mj.mgr.initCards(data.cards)\r\n                // 刷新手牌\r\n                // cc.mj.mgr.discard({ type: data.type, value: data.value })\r\n                this.refreshSelfCards()\r\n            }\r\n        })\r\n        // 抓牌\r\n        cc.mj.evt.regEvt(\"NewDiscard\", (data) => {\r\n            this.findNode(this.dir, \"event_handler\").removeAllChildren()\r\n            let dir = Utils.dirFromSeat(data.seat)\r\n            cc.mj.mgr.cur_seat = data.seat\r\n            let node_new = this.findNode(dir, \"cur.normal.new\")\r\n\r\n            if (dir == this.dir && node_new._children.length && !node_new._children[0].active) {\r\n                let node = this.findNode(this.dir, \"cur.normal.old\")\r\n                let node_card = node._children[cc.mj.mgr.self_cards.length - 1]\r\n                node_card.active = false\r\n                let card_cs = node_card.getComponent(\"CurCard\")\r\n                let new_card = node_new._children[0]\r\n                new_card.getComponent(\"CurCard\").init(this.dir, card_cs.type, card_cs.value, card_cs.laizi, this)\r\n                new_card.active = true\r\n            } else if (dir != this.dir && node_new._children.length && !node_new._children[0].active) {\r\n\r\n                // this.findNode(dir, \"cur.normal.old\")._children[this.findNode(dir, \"cur.normal.old\")._children.length - 1].parent = null\r\n                // node_new._children[0].active = true\r\n\r\n                // console.log(node_new)\r\n            }\r\n            this.newTurn()\r\n            this.handle_next()\r\n        })\r\n\r\n        // 抓牌\r\n        cc.mj.evt.regEvt(\"SupplyCard\", (data) => {\r\n            this.findNode(this.dir, \"event_handler\").removeAllChildren()\r\n\r\n            this.remainder_cards.string = data.card_num\r\n            let dir = Utils.dirFromSeat(data.seat)\r\n            if (data.card) {\r\n                let card = Utils.parseCard(data.card)\r\n                let node_new = this.findNode(dir, \"cur.normal.new\")\r\n                let new_card = null\r\n                if (node_new._children.length) {\r\n                    node_new._children[0].active = true\r\n                    new_card = node_new._children[0]\r\n                } else {\r\n                    new_card = cc.instantiate(this.cur_card_prefab_dict[dir]);\r\n                    new_card.parent = node_new\r\n                }\r\n                if (data.uid == cc.mj.mgr.uid) {\r\n                    new_card.getComponent(\"CurCard\").init(this.dir, card.type, card.value, card.laizi, this)\r\n                    !this.ignore_animation && cc.audio.playHandleCard(\"deal_card\")\r\n                    //cc.mj.mgr.getNewCard({ type: card.type, value: card.value, laizi: card.laizi })\r\n                    //this.refreshSelfCards()\r\n                }\r\n            }\r\n            this.newTurn()\r\n            this.handle_next()\r\n        })\r\n        // 补花\r\n        cc.mj.evt.regEvt(\"ReplaceHua\", (data) => {\r\n            this.remainder_cards.string = data.card_num\r\n            let dir = Utils.dirFromSeat(data.seat)\r\n            this.play_animation(data.seat, this.ani_hua_prefab, 600, () => {\r\n                this.handle_next()\r\n            })\r\n            this.findNode(dir, \"hua\").active = true\r\n            this.findNode(dir, \"hua.num\")._components[0].string = data.cur_hua\r\n            if (data.uid == cc.mj.mgr.uid && data.rpl_cards) {\r\n                if (data.cards) {\r\n                    cc.mj.mgr.initCards(data.cards)\r\n                } else {\r\n                    for (let i = 0; i < data.rpl_cards.length; i++) {\r\n                        let rpl_card = data.rpl_cards[i]\r\n                        cc.mj.mgr.replaceCard({ type: rpl_card.type0, value: rpl_card.value0 }, { type: rpl_card.type1, value: rpl_card.value1, laizi: rpl_card.laizi })\r\n                    }\r\n                }\r\n                this.refreshSelfCards()\r\n            }\r\n        })\r\n        cc.mj.evt.regEvt(\"MakeSureHandler\", (data) => {\r\n            if (data.uid != cc.mj.mgr.uid)\r\n                return this.handle_next()\r\n\r\n            let event_handler_node = this.findNode(this.dir, \"event_handler\")\r\n            for (let i = 0; i < data.evts.length; i++) {\r\n                let event = data.evts[i]\r\n                let event_btn = cc.instantiate(this.event_handler_prefab)\r\n                let cs = event_btn.getComponent('Handler')\r\n                cs.init(event.event, event.type, event.selects, event.state, event_handler_node)\r\n                event_btn.parent = event_handler_node\r\n            }\r\n            let guo_btn = cc.instantiate(this.event_handler_prefab)\r\n            let cs_guo = guo_btn.getComponent('Handler')\r\n            cs_guo.init(0, null, null, null, event_handler_node)\r\n            guo_btn.parent = event_handler_node\r\n            this.newDeadline()\r\n            this.handle_next()\r\n        })\r\n\r\n        cc.mj.evt.regEvt(\"HandleEvent\", (data) => {\r\n            if (!data.event) return !this.ignore_animation && this.handle_next()\r\n\r\n            let dir = Utils.dirFromSeat(data.seat)\r\n            let from_dir = Utils.dirFromSeat(data.from_seat)\r\n            let event_cards_node = this.findNode(dir, \"cur.event\")\r\n            event_cards_node.active = true\r\n            if (dir != from_dir) {\r\n                this.last_out_card && (this.last_out_card.parent = null) && (this.last_out_card = null)\r\n                if (from_dir == 1) {\r\n                    for (let i = 0; i < this.right_out_cards.length; i++) {\r\n                        if (this.right_out_cards[i].last_discard) {\r\n                            this.right_out_cards.splice(i, 1)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (!this.ignore_animation) {\r\n                cc.audio.playEvent(data.event)\r\n                let ani_event = cc.instantiate(this.ani_event_prefab)\r\n                ani_event.parent = this.findNode(dir, \"ani_event\")\r\n                ani_event.getComponent(\"AniEvent\").init(data.event)\r\n                this.runAfter(() => { ani_event.parent = null; this.handle_next() }, 500)\r\n            }\r\n            // 杠\r\n            if (data.event == 4) {\r\n                let state = data.state\r\n                let remove_num = state == null ? (dir == from_dir ? 1 : 0) : (state == 4 ? 4 : 3)\r\n                if (state == null) {\r\n                    for (let i = 0; i < event_cards_node._children.length; i++) {\r\n                        let event_card = event_cards_node._children[i]\r\n                        let cs = event_card.getComponent(\"EventCard\")\r\n                        if (cs.type == data.type && cs.value == data.value) {\r\n                            cs.init(dir, from_dir, data.event, data.type, data.value, state)\r\n                            break\r\n                        }\r\n                    }\r\n                    remove_num = 1\r\n                } else {\r\n                    let peng = cc.instantiate(this.peng_prefab_dict[dir])\r\n                    peng.getComponent(\"EventCard\").init(dir, from_dir, data.event, data.type, data.value, state)\r\n                    peng.parent = event_cards_node\r\n                }\r\n                if (dir == from_dir) this.findNode(dir, \"cur.normal.new\")._children[0].active = false\r\n                data.uid == cc.mj.mgr.uid ? cc.mj.mgr.gang(data.type, data.value, remove_num) : this.otherEvent(dir, from_dir, data.event, state)\r\n            } else if (data.event == 3) {\r\n                // 碰\r\n                let peng = cc.instantiate(this.peng_prefab_dict[dir])\r\n                peng.getComponent(\"EventCard\").init(dir, from_dir, data.event, data.type, data.value)\r\n                peng.parent = event_cards_node\r\n\r\n                data.uid == cc.mj.mgr.uid ? cc.mj.mgr.peng(data.type, data.value) : this.otherEvent(dir, from_dir, data.event, null)\r\n            } else if (data.event == 2) {\r\n                // 吃\r\n                let peng = cc.instantiate(this.peng_prefab_dict[dir])\r\n                peng.getComponent(\"EventCard\").init(dir, from_dir, data.event, data.type, data.value, null, data.value1, data.value2)\r\n                peng.parent = event_cards_node\r\n\r\n                data.uid == cc.mj.mgr.uid ? cc.mj.mgr.chi(data.type, data.value1, data.value2) : this.otherEvent(dir, from_dir, data.event, null)\r\n            }\r\n            // 移除手牌\r\n            if (data.uid == cc.mj.mgr.uid) {\r\n                cc.mj.mgr.initCards(data.cards)\r\n                this.refreshSelfCards()\r\n            }\r\n            !this.ignore_animation && this.handle_next()\r\n        })\r\n        cc.mj.evt.regEvt(\"UserWin\", (data) => {\r\n            let seat = data.role.seat\r\n            let ani_event = null\r\n            if (seat != null) {\r\n                cc.audio.playEvent(5)\r\n                let dir = Utils.dirFromSeat(seat)\r\n                ani_event = cc.instantiate(this.ani_event_prefab)\r\n                ani_event.parent = this.findNode(dir, \"ani_event\")\r\n                ani_event.getComponent(\"AniEvent\").init(data.event, data.state)\r\n            }\r\n            this.exit()\r\n            this.runAfter(() => {\r\n                ani_event && (ani_event.parent = null)\r\n                cc.game.off(cc.game.EVENT_SHOW, this.onShow, this)\r\n                cc.mj.result = data\r\n                cc.director.loadScene(\"report1\")\r\n            }, seat && !this.ignore_animation ? 1000 : 0)\r\n        })\r\n        cc.mj.evt.regEvt(\"KaiJin\", (data) => {\r\n            this.play_animation(data.seat, this.ani_kaijin_prefab, 800, () => {\r\n                this.handle_next()\r\n            })\r\n\r\n            let dir = Utils.dirFromSeat(cc.mj.mgr.self_seat)\r\n            cc.mj.mgr.kaijin(data.type, data.value)\r\n            this.refreshSelfCards()\r\n            let cs = this.laizi_show.getComponent(\"OutCard\")\r\n            cs.init(dir, data.type, data.value)\r\n            this.laizi_show.active = true\r\n        })\r\n\r\n        cc.mj.evt.regEvt(\"Prepare\", (data) => {\r\n            cc.log(data)\r\n            for (let i = 0; i < data.roles.length; i++) {\r\n                let role = data.roles[i]\r\n                let dir = Utils.dirFromSeat(role.seat)\r\n                let prepare_header = this.findNode(dir, 'prepare_header')\r\n                prepare_header.active = true\r\n                prepare_header.removeAllChildren()\r\n                if (role.uid) {\r\n                    let header = cc.instantiate(this.header_prefab)\r\n                    let cs = header.getComponent(\"Header\")\r\n                    cs.init(this, dir, role.uid, role.name, role.icon, role.money)\r\n                    header.parent = prepare_header\r\n                    this.findNode(dir, \"prepare\").active = role.prepare\r\n                } else {\r\n                    this.findNode(dir, \"prepare\").active = false\r\n                }\r\n            }\r\n            this.handle_event()\r\n        })\r\n\r\n        cc.mj.evt.regEvt(\"HaiDiLaoYue\", (data) => {\r\n            this.findNode(this.dir, \"event_handler\").removeAllChildren()\r\n            this.remainder_cards.string = 0\r\n            for (let i = 0; i < data.roles.length; i++) {\r\n                let role = data.roles[i]\r\n                let dir = Utils.dirFromSeat(role.role.seat)\r\n                let card = role.card\r\n                let card_node = cc.instantiate(this.self_cur_card_prefab);\r\n                card_node.getComponent(\"CurCard\").init(this.dir, card.type, card.value, card.laizi, this)\r\n                card_node.parent = this.findNode(dir, \"ani_event\")\r\n\r\n                if (dir == this.dir) continue\r\n\r\n                this.findNode(dir, \"cur.normal.old\").removeAllChildren()\r\n                for (let j = 0; j < role.cards.length; j++) {\r\n                    let card = role.cards[j]\r\n                    let out_card = cc.instantiate(this.out_card_prefab_dict[dir]);\r\n                    out_card.parent = this.findNode(dir, \"cur.normal.old\")\r\n                    if (dir == 1 || dir == 3) {\r\n                        this.findNode(dir, \"cur.normal.old\").getComponent(cc.Layout).spacingY = -15\r\n                    }\r\n                    out_card.getComponent(\"OutCard\").init(dir, card.type, card.value)\r\n                }\r\n            }\r\n            this.runAfter(() => { this.handle_next() }, 2500);\r\n        })\r\n        // 解散房间\r\n        cc.mj.evt.regEvt(\"MakeSureDismiss\", (data) => {\r\n            cc.scene.showPrefab(\"解散房间\", false, (node) => {\r\n                node.getComponent(\"DismissMsg\").init(data)\r\n            })\r\n            this.handle_next()\r\n        })\r\n\r\n        cc.mj.evt.regEvt(\"ExitGame\", (data) => {\r\n            console.log(\"ExitGame\")\r\n            if (data.uid != cc.mj.user.uid) return\r\n            this.exit()\r\n            let room_type = this.room.option.type\r\n            cc.mjroom = null\r\n            if (room_type == \"PERSONAL\") {\r\n                cc.director.loadScene(\"hall\")\r\n            } else {\r\n                cc.club_type = room_type\r\n                cc.director.loadScene(\"club\")\r\n            }\r\n        })\r\n\r\n        cc.mj.evt.regEvt(\"DismissResult\", (data) => {\r\n            let content = \"\"\r\n            if (data.dismissed) {\r\n                content = \"经玩家\"\r\n                let names = []\r\n                for (let i = 0; i < data.roles.length; i++) {\r\n                    names.push(\"【\" + data.roles[i].name + \"】\")\r\n                }\r\n                content += names.join(\",\")\r\n                content += \"同意，房间解散成功\"\r\n            } else {\r\n                content = \"由于玩家【\" + data.refused.name + \"】拒绝，解散房间失败，游戏继续\"\r\n            }\r\n            Task.pause()\r\n            cc.scene.onShowTips(\"OK\", content, () => {\r\n                this.handle_next()\r\n                Task.resume()\r\n            })\r\n        })\r\n\r\n\r\n        cc.mj.evt.regEvt(\"SendMsg\", (data) => {\r\n            if (!this.ignore_animation) {\r\n                this.chat_msgs.push(data)\r\n                if (this.ignore_animation) return this.handle_next()\r\n                let dir = Utils.dirFromSeat(data.seat)\r\n                let chat_node = cc.instantiate(this.chat_dict[dir])\r\n                chat_node.parent = this.findNode(dir, \"gaming_chat\")\r\n                chat_node.getComponent(\"GameChat\").init(dir, data.msg)\r\n                cc.audio.playSFX(this.msgSFX(data.msg))\r\n\r\n                this.handle_next()\r\n            }\r\n        })\r\n\r\n        cc.mj.evt.regEvt(\"Offline\", (data) => {\r\n            if (!this.ignore_animation) {\r\n                let dir = Utils.dirFromSeat(data.seat)\r\n                try {\r\n                    this.findNode(dir, \"gaming_header\")._children[0].getComponent(\"Header\").set_offline(data.offline)\r\n                } catch (e) { }\r\n\r\n                this.handle_event()\r\n            }\r\n        })\r\n\r\n        cc.mj.evt.regEvt(\"SendBiaoQing\", (data) => {\r\n            if (!this.ignore_animation) {\r\n                let from_dir = Utils.dirFromSeat(data.from_seat)\r\n                let to_dir = Utils.dirFromSeat(data.to_seat)\r\n                for (let i = 0; i < data.times; i++) {\r\n                    this.runAfter(() => {\r\n                        let biaoqing = cc.instantiate(this.biaoqing_prefab)\r\n                        biaoqing.getComponent(\"BiaoQing\").init(data.biaoqing, from_dir, to_dir)\r\n                        biaoqing.parent = this.node\r\n\r\n                    }, i * 180)\r\n                }\r\n\r\n                this.handle_next()\r\n            }\r\n        })\r\n    },\r\n    otherEvent: function (dir, from_dir, event, state) {\r\n        // chi or peng\r\n        if (event != 4) {\r\n            let remove_num = 2;\r\n            let cur_cards_node = this.findNode(dir, \"cur.normal.old\")\r\n            while (remove_num) {\r\n                if (dir != 4) {\r\n                    cur_cards_node._children[cur_cards_node._children.length - 1].parent = null\r\n                } else {\r\n                    cur_cards_node._children[0].active = false\r\n                }\r\n                remove_num -= 1\r\n            }\r\n        } else {\r\n            let remove_num = state == null ? 0 : 3;\r\n            let cur_cards_node = this.findNode(dir, \"cur.normal.old\")\r\n            if (dir != 4) {\r\n                while (remove_num) {\r\n                    cur_cards_node._children[cur_cards_node._children.length - 1].parent = null\r\n                    remove_num -= 1\r\n                }\r\n            } else {\r\n                for (let i = 0; i < remove_num; i++) {\r\n                    cur_cards_node._children[i].active = false\r\n                }\r\n            }\r\n            // 自己抓杠\r\n            if (dir == from_dir) {\r\n                this.findNode(dir, \"cur.normal.new\")._children[0].active = false\r\n            }\r\n        }\r\n    },\r\n    exit: function () {\r\n        cc.log(\"exit\")\r\n        http.stopHeartbeat()\r\n        this.finished = true\r\n    },\r\n    msgSFX: function (msg) {\r\n        var COMMON_MSG = [\r\n            \"你太牛了\",\r\n            \"哈哈，手气真好\",\r\n            \"快点出牌噢\",\r\n            \"今天真高兴\",\r\n            \"这个吃的好\",\r\n            \"你放炮我不胡\",\r\n            \"你家里是开银行的吧\",\r\n            \"不好意思，我有事要先走一步\",\r\n            \"你的牌打的太好啦\",\r\n            \"大家好，很高兴见到各位\",\r\n            \"怎么又断线了啊，网络怎么这么差啊\",\r\n        ]\r\n        for (let i = 0; i < COMMON_MSG.length; i++) {\r\n            if (msg == COMMON_MSG[i]) return \"common_woman/fix_msg_\" + (i + 1) + \".mp3\"\r\n        }\r\n        return null\r\n    },\r\n    _onDisable: function () {\r\n        this.exit()\r\n    },\r\n    // called every frame\r\n    update: function (dt) {\r\n    },\r\n});\r\n"]}