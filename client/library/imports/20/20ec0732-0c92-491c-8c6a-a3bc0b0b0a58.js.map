{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\lib/assets\\Script\\lib\\ScenePopWin.js"],"names":["cc","Class","extends","Component","properties","node_popwin_bottom","Node","popwin_mask_bottom","delay_popwin","node_popwin_up","popwin_mask_up","onLoad","scene","popwin_cache","_onLoad","onDisable","_onDisable","onShowTips","type","content","ok_cb","cancel_cb","icon","showPrefab","node","getComponent","init","name","force","cb","console","log","loader","loadRes","Prefab","err","prefab","message","instantiate","showPopWin","_showPopWinBottom","_children","length","push","active","opacity","runAction","fadeTo","parent","sequence","scaleTo","_showPopWinUp","_closePopWinBottom","callFunc","new_node","splice","_closePopWinUp","closePopWin","gotoGame","director","loadScene","showWaiting","Task","runAfter"],"mappings":"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","file":"ScenePopWin.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\lib","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        node_popwin_bottom: cc.Node,\r\n        popwin_mask_bottom: cc.Node,\r\n        delay_popwin: [],\r\n        node_popwin_up: cc.Node,\r\n        popwin_mask_up: cc.Node,\r\n    },\r\n    onLoad: function () {\r\n        cc.scene = this\r\n        this.popwin_cache = {}\r\n        this._onLoad()\r\n    },\r\n    onDisable: function () {\r\n        this._onDisable && this._onDisable()\r\n    },\r\n    onShowTips: function (type, content, ok_cb, cancel_cb, icon) {\r\n        this.showPrefab(\"提示框\", true, (node) => {\r\n            node.getComponent(\"Tips\").init(content, type, ok_cb, cancel_cb, icon)\r\n        })\r\n    },\r\n    showPrefab: function (name, force, cb) {\r\n        if (this.popwin_cache[name]) {\r\n            if (this.popwin_cache[name] == -1) {\r\n                console.log(\"waiting\", name)\r\n            }\r\n            else {\r\n                console.log(\"opened\", name)\r\n            }\r\n            return\r\n        }\r\n        this.popwin_cache[name] = -1\r\n        cc.loader.loadRes(\"Prefab/\" + name, cc.Prefab, (err, prefab) => {\r\n            if (err) {\r\n                console.log(err.message || err);\r\n                return;\r\n            }\r\n            let node = cc.instantiate(prefab)\r\n            cb && cb(node)\r\n            this.showPopWin(node, force)\r\n            this.popwin_cache[name] = 1\r\n        });\r\n    },\r\n    _showPopWinBottom: function (node) {\r\n        if (this.node_popwin_bottom._children.length > 0) {\r\n            this.delay_popwin.push(node)\r\n            return\r\n        }\r\n        if (!this.popwin_mask_bottom.active) {\r\n            this.popwin_mask_bottom.active = true\r\n            this.popwin_mask_bottom.opacity = 0\r\n            this.popwin_mask_bottom.runAction(cc.fadeTo(0.3, 120))\r\n        }\r\n        node.parent = this.node_popwin_bottom\r\n        node.runAction(cc.sequence([cc.fadeTo(0.2, 255), cc.scaleTo(0.1, 1.0)]))\r\n    },\r\n    _showPopWinUp: function (node) {\r\n        if (!this.popwin_mask_up.active) {\r\n            this.popwin_mask_up.active = true\r\n            this.popwin_mask_up.opacity = 0\r\n            this.popwin_mask_up.runAction(cc.fadeTo(0.3, 120))\r\n        }\r\n        node.parent = this.node_popwin_up\r\n        node.runAction(cc.sequence([cc.fadeTo(0.2, 255), cc.scaleTo(0.1, 1.0)]))\r\n    },\r\n    showPopWin: function (node, force) {\r\n        force ? this._showPopWinUp(node) : this._showPopWinBottom(node)\r\n    },\r\n    _closePopWinBottom: function (node) {\r\n        node.runAction(cc.sequence(cc.fadeTo(0.2, 0.0), cc.callFunc(() => {\r\n            node.parent = null\r\n            this.popwin_cache[node.name] = 0\r\n            if (this.delay_popwin.length) {\r\n                let new_node = this.delay_popwin[0]\r\n                this.delay_popwin.splice(0, 1)\r\n                return this.showPopWin(new_node)\r\n            }\r\n            if (this.node_popwin_bottom._children.length <= 0) {\r\n                this.popwin_mask_bottom.runAction(cc.sequence([\r\n                    cc.fadeTo(0.1, 0),\r\n                    cc.callFunc(() => {\r\n                        this.popwin_mask_bottom.active = false\r\n                    })\r\n                ]))\r\n            }\r\n        })))\r\n    },\r\n    _closePopWinUp: function (node) {\r\n        node.runAction(cc.sequence(cc.fadeTo(0.2, 0.0), cc.callFunc(() => {\r\n            node.parent = null\r\n            this.popwin_cache[node.name] = 0\r\n            if (this.node_popwin_up._children.length <= 0) {\r\n                this.popwin_mask_up.runAction(cc.sequence([\r\n                    cc.fadeTo(0.1, 0),\r\n                    cc.callFunc(() => {\r\n                        this.popwin_mask_up.active = false\r\n                    })\r\n                ]))\r\n            }\r\n        })))\r\n    },\r\n    closePopWin: function (node) {\r\n        if (!node || node.parent == null) return\r\n        if (node.parent != this.node_popwin_bottom && node.parent != this.node_popwin_up) {\r\n            node.parent = null\r\n            return\r\n        }\r\n        node.parent == this.node_popwin_up ? this._closePopWinUp(node) : this._closePopWinBottom(node)\r\n    },\r\n    gotoGame: function (content) {\r\n        this.showPrefab(\"等待\", true, (node) => {\r\n            node.getComponent(\"Waiting\").init(content)\r\n        })\r\n        cc.director.loadScene(\"mjgame\")\r\n    },\r\n    showWaiting: function (content, cb) {\r\n        this.showPrefab(\"等待\", true, (node) => {\r\n            node.getComponent(\"Waiting\").init(content)\r\n            cb && cb(node)\r\n            Task.runAfter(5000, () => { this.closePopWin(node) })\r\n        })\r\n    },\r\n});\r\n"]}