{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\DismissMsg.js"],"names":["cc","Class","extends","Component","properties","content","default","type","Label","num","btn_agree","Node","btn_refuse","isSSS","onLoad","deadline","state","dismiss_uid","self","timer_cb","string","Task","offTask","mj","user","uid","agree","onTask","init","data","dismiss_user","active","name","i","roles","length","role","onGgree","sssNet","send","http","sendGame","method","resp","onRefuse","onDisable"],"mappings":"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","file":"DismissMsg.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        content: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        num: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        btn_agree: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        btn_refuse: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        isSSS:false,\r\n    },\r\n    onLoad: function () {\r\n        this.deadline = 300\r\n        this.state = null\r\n        this.dismiss_uid = null\r\n\r\n        let self = this\r\n        this.timer_cb = function () {\r\n            self.deadline -= 1\r\n            self.num.string = self.deadline\r\n            if (self.deadline == 0) {\r\n                Task.offTask(self.timer_cb)\r\n                self.dismiss_uid != cc.mj.user.uid && self.state == null && self.agree()\r\n            }\r\n        }\r\n        Task.onTask(1000, this.timer_cb)\r\n    },\r\n    init: function (data,type) {\r\n        if(type && type==\"SSS\"){\r\n            this.isSSS=true\r\n        }else{\r\n            this.dismiss_uid = data.dismiss_user.uid\r\n            if (this.dismiss_uid == cc.mj.user.uid || this.state != null) {\r\n                this.btn_agree.active = false\r\n                this.btn_refuse.active = false\r\n            }\r\n            let content = \"玩家【\" + data.dismiss_user.name + \"】申请解散房间，\"\r\n            content += (this.dismiss_uid == cc.mj.user.uid || this.state != null) ? \"请等待其他玩家确认\" : \"请问是否同意？\"\r\n            content += \"(超过5分钟未做选择，则默认同意)\\n\"\r\n            for (let i = 0; i < data.roles.length; i++) {\r\n                let role = data.roles[i]\r\n                content += \"【\" + role.name + \"】\" + (role.state == null ? \"等待选择\" : (role.state ? \"同意解散\" : \"拒绝解散\")) + \"\\n\"\r\n            }\r\n            this.content.string = content\r\n        }\r\n        \r\n    },\r\n    onGgree: function () {\r\n        if(this.isSSS){\r\n            cc.sssNet.send(\"dissolve_agree\");\r\n            return ;\r\n        }\r\n        this.state = true\r\n        http.sendGame({ method: \"agree_dismiss\" }, (resp) => { })\r\n    },\r\n    onRefuse: function () {\r\n        if(this.isSSS){\r\n            cc.sssNet.send(\"dissolve_reject\");\r\n            return ;\r\n        }\r\n        this.state = false\r\n        http.sendGame({ method: \"refuse_dismiss\" }, (resp) => { })\r\n    },\r\n    onDisable: function () {\r\n        this.timer_cb && Task.offTask(this.timer_cb)\r\n    }\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    // start () {\r\n\r\n    // },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}