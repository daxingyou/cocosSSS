{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\IntegralRecord.js"],"names":["cc","Class","extends","Component","properties","one_record_prefab","default","type","Prefab","content","Node","waiting_prefab","init","club_id","node","on","EventType","TOUCH_START","parent","waiting","instantiate","getComponent","setTimeout","http","sendHall","method","resp","showHistories","load_idx","records","i","length","record","setPosition","height","update","dt"],"mappings":";;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,2BAAmB;AACfC,qBAAS,IADM;AAEfC,kBAAMP,GAAGQ;AAFM,SADX;AAKRC,iBAAS;AACLH,qBAAS,IADJ;AAELC,kBAAMP,GAAGU;AAFJ,SALD;AASRC,wBAAgB;AACZL,qBAAS,IADG;AAEZC,kBAAMP,GAAGQ;AAFG;AAIhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3BQ,KAHP;AAgCLI,UAAM,cAAUC,OAAV,EAAmB;AAAA;;AACrB,aAAKC,IAAL,CAAUC,EAAV,CAAaf,GAAGU,IAAH,CAAQM,SAAR,CAAkBC,WAA/B,EAA4C,YAAM;AAAE,kBAAKH,IAAL,CAAUI,MAAV,GAAmB,IAAnB;AAAyB,SAA7E;AACA,YAAIC,UAAUnB,GAAGoB,WAAH,CAAe,KAAKT,cAApB,CAAd;AACAQ,gBAAQE,YAAR,CAAqB,SAArB,EAAgCT,IAAhC,CAAqC,UAArC;AACAO,gBAAQD,MAAR,GAAiB,KAAKJ,IAAtB;AACAQ,mBAAW,YAAM;AACbH,oBAAQD,MAAR,GAAiB,IAAjB;AACH,SAFD,EAEG,GAFH;AAGAK,aAAKC,QAAL,CAAc,EAAEC,QAAQ,kBAAV,EAA8BZ,SAASA,OAAvC,EAAd,EAAgE,UAACa,IAAD,EAAU;AACtE,kBAAKC,aAAL,CAAmBD,IAAnB;AACH,SAFD;AAGH,KA3CI;AA4CLC,mBAAe,uBAAUD,IAAV,EAAgB;AAC3B,aAAKE,QAAL,GAAgB,CAAhB;AACA,aAAKC,OAAL,GAAeH,KAAKG,OAApB;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,EAAJ,IAAUA,IAAIJ,KAAKG,OAAL,CAAaE,MAA3C,EAAmDD,GAAnD,EAAwD;AACpD,gBAAIE,SAASN,KAAKG,OAAL,CAAaC,CAAb,CAAb;AACA,gBAAIhB,OAAOd,GAAGoB,WAAH,CAAe,KAAKf,iBAApB,CAAX;AACAS,iBAAKO,YAAL,CAAkB,WAAlB,EAA+BT,IAA/B,CAAoCoB,MAApC;AACAlB,iBAAKI,MAAL,GAAc,KAAKT,OAAnB;AACAK,iBAAKmB,WAAL,CAAiB,CAAjB,EAAoB,EAAEnB,KAAKoB,MAAL,GAAc,EAAhB,IAAsBJ,CAA1C;AACA,iBAAKrB,OAAL,CAAayB,MAAb,GAAsB,CAACpB,KAAKoB,MAAL,GAAc,EAAf,KAAsBJ,IAAI,CAA1B,CAAtB;AACH;AACJ,KAvDI;AAwDL;;AAEA;;AAEA;;AAEA;;AAEAK,UAhEK,kBAgEEC,EAhEF,EAgEM;AACP,YAAI,KAAKP,OAAL,IAAgB,KAAKD,QAAL,GAAgB,KAAKC,OAAL,CAAaE,MAAjD,EAAyD;AACrD,gBAAIC,SAAS,KAAKH,OAAL,CAAa,KAAKD,QAAlB,CAAb;AACA,gBAAId,OAAOd,GAAGoB,WAAH,CAAe,KAAKf,iBAApB,CAAX;AACAS,iBAAKO,YAAL,CAAkB,WAAlB,EAA+BT,IAA/B,CAAoCoB,MAApC;AACAlB,iBAAKI,MAAL,GAAc,KAAKT,OAAnB;AACAK,iBAAKmB,WAAL,CAAiB,CAAjB,EAAoB,EAAEnB,KAAKoB,MAAL,GAAc,EAAhB,IAAsB,KAAKN,QAA/C;AACA,iBAAKnB,OAAL,CAAayB,MAAb,GAAsB,CAACpB,KAAKoB,MAAL,GAAc,EAAf,KAAsB,KAAKN,QAAL,GAAgB,CAAtC,CAAtB;AACA,iBAAKA,QAAL,IAAiB,CAAjB;AACH;AACJ;AA1EI,CAAT","file":"IntegralRecord.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        one_record_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        content: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        waiting_prefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n    },\r\n    init: function (club_id) {\r\n        this.node.on(cc.Node.EventType.TOUCH_START, () => { this.node.parent = null })\r\n        let waiting = cc.instantiate(this.waiting_prefab)\r\n        waiting.getComponent(\"Waiting\").init(\"正在获取积分记录\")\r\n        waiting.parent = this.node\r\n        setTimeout(() => {\r\n            waiting.parent = null\r\n        }, 300)\r\n        http.sendHall({ method: \"integral_history\", club_id: club_id }, (resp) => {\r\n            this.showHistories(resp)\r\n        })\r\n    },\r\n    showHistories: function (resp) {\r\n        this.load_idx = 0\r\n        this.records = resp.records\r\n        for (let i = 0; i < 20 && i < resp.records.length; i++) {\r\n            let record = resp.records[i]\r\n            let node = cc.instantiate(this.one_record_prefab)\r\n            node.getComponent(\"OneRecord\").init(record)\r\n            node.parent = this.content\r\n            node.setPosition(0, -(node.height + 15) * i);\r\n            this.content.height = (node.height + 15) * (i + 1)\r\n        }\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    // start () {\r\n\r\n    // },\r\n\r\n    update(dt) {\r\n        if (this.records && this.load_idx < this.records.length) {\r\n            let record = this.records[this.load_idx]\r\n            let node = cc.instantiate(this.one_record_prefab)\r\n            node.getComponent(\"OneRecord\").init(record)\r\n            node.parent = this.content\r\n            node.setPosition(0, -(node.height + 15) * this.load_idx);\r\n            this.content.height = (node.height + 15) * (this.load_idx + 1)\r\n            this.load_idx += 1\r\n        }\r\n    },\r\n});\r\n"]}